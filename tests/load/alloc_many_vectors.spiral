(program
  (fun alloc-use-vec (depth)
    (var vec-1 (vec-make 100))
    (vec-set! vec-1 4 depth)
    (vec-set! vec-1 2 vec-1)
    (var vec-2 vec-1)
    (var prev-ok (alloc-drop-vec (- depth 1)))
    (vec-set! vec-2 5 100)
    (and 
      prev-ok
      (== (vec-get vec-1 4) depth)
      (== (vec-get vec-2 4) depth)
      (== (vec-get (vec-get vec-1 2) 4) depth)
      (== (vec-get (vec-get vec-2 2) 4) depth)
      (== (vec-get vec-1 5) 100)
      (== (vec-get vec-2 5) 100)
      (== (vec-get (vec-get vec-1 2) 5) 100)
      (== (vec-get (vec-get vec-2 2) 5) 100)))
  (fun alloc-drop-vec (depth)
    (vec-make 100)
    (if (> depth 0) (alloc-use-vec (- depth 1)) true))
  (println (alloc-drop-vec 1000)))
